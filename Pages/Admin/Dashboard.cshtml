@page
@model LendSecure.Pages.Admin.DashboardModel
@{
    ViewData["Title"] = "Admin Dashboard";
}

<link rel="stylesheet" href="~/css/admin-dashboard.css" asp-append-version="true" />

<div class="admin-container">
    <!-- Page Header -->
    <div class="page-header-card">
        <div class="header-icon-box">
            <i class="bi bi-shield-lock"></i>
            <!-- Fallback icon -->
            🛡️
        </div>
        <div class="header-content">
            <h2>Admin Dashboard</h2>
            <p>Welcome, @Model.UserEmail</p>
        </div>
    </div>

    <!-- Platform Stats -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon-circle icon-blue">
                <i class="bi bi-people"></i>
                👥
            </div>
            <div class="stat-content">
                <h5>Total Users</h5>
                <h2>@Model.TotalUsers</h2>
                <small>Registered accounts</small>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon-circle icon-yellow">
                <i class="bi bi-file-earmark-text"></i>
                📋
            </div>
            <div class="stat-content">
                <h5>Pending KYC</h5>
                <h2>@Model.PendingKYCCount</h2>
                <small>Need review</small>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon-circle icon-teal">
                <i class="bi bi-hourglass-split"></i>
                ⏳
            </div>
            <div class="stat-content">
                <h5>Pending Loans</h5>
                <h2>@Model.PendingLoansCount</h2>
                <small>Need approval</small>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon-circle icon-green">
                <i class="bi bi-cash-coin"></i>
                💵
            </div>
            <div class="stat-content">
                <h5>Active Loans</h5>
                <h2>@Model.ActiveLoansCount</h2>
                <small>Currently funded</small>
            </div>
        </div>
    </div>

    <!-- Admin Actions -->
    <div class="actions-section">
        <div class="section-header">
            <i class="bi bi-lightning-charge-fill"></i>
            <h5>Admin Actions</h5>
        </div>
        <div class="actions-grid">
            <a href="/Admin/KYCReview" class="btn-action btn-action-yellow">
                <i class="bi bi-file-earmark-check"></i>
                <span>Review KYC (@Model.PendingKYCCount)</span>
            </a>
            <a href="/Admin/LoanApprovals" class="btn-action btn-action-teal">
                <i class="bi bi-check-circle"></i>
                <span>Approve Loans (@Model.PendingLoansCount)</span>
            </a>
            <a href="/Admin/Users" class="btn-action btn-action-blue">
                <i class="bi bi-people-fill"></i>
                <span>Manage Users</span>
            </a>
            <a href="/Admin/AuditLogs" class="btn-action btn-action-gray">
                <i class="bi bi-clipboard-data"></i>
                <span>View Audit Logs</span>
            </a>
        </div>
    </div>

    <!-- Recent Activity -->
    <div class="activity-grid">
        <!-- Recent KYC -->
        <div class="activity-card">
            <div class="section-header">
                <i class="bi bi-clock-history"></i>
                <h5>Recent KYC Submissions</h5>
            </div>
            @if (Model.RecentKYCDocs.Any())
            {
                <ul class="activity-list">
                    @foreach (var doc in Model.RecentKYCDocs.Take(5))
                    {
                        <li class="activity-item">
                            <span class="activity-text">@doc.User.Email</span>
                            <span class="badge-pending">@doc.Status</span>
                        </li>
                    }
                </ul>
                <a href="/Admin/KYCReview" class="btn-view-all">View All</a>
            }
            else
            {
                <div class="empty-state">
                    No pending KYC documents
                </div>
            }
        </div>

        <!-- Recent Loan Requests -->
        <div class="activity-card">
            <div class="section-header">
                <i class="bi bi-file-earmark-text"></i>
                <h5>Recent Loan Requests</h5>
            </div>
            @if (Model.RecentLoanRequests.Any())
            {
                <ul class="activity-list">
                    @foreach (var loan in Model.RecentLoanRequests.Take(5))
                    {
                        <li class="activity-item">
                            <span class="activity-text">@loan.Borrower.Email</span>
                            <span class="badge-pending">@loan.Status</span>
                        </li>
                    }
                </ul>
                <a href="/Admin/LoanApprovals" class="btn-view-all">View All</a>
            }
            else
            {
                <div class="empty-state">
                    No pending loan requests
                </div>
            }
        </div>
    </div>

    <!-- Account Information -->
    <div class="account-card">
        <div class="section-header">
            <i class="bi bi-person-circle"></i>
            <h5>Account Information</h5>
        </div>
        <div class="account-details">
            <div class="detail-row">
                <span class="detail-label">Email:</span>
                <span class="detail-value">@Model.UserEmail</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Role:</span>
                <span class="detail-value">Admin</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Member Since:</span>
                <span class="detail-value">@Model.CreatedAt.ToString("MMMM dd, yyyy")</span>
            </div>
            <a href="/Account/Logout" class="btn-logout">
                <i class="bi bi-box-arrow-right"></i>
                Logout
            </a>
        </div>
    </div>
</div>